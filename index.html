<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Spectre Hologram">
    <title>Spectre Hologram Workshop - SJSU School of Information</title>
    <link rel="icon" type="image/jpeg" href="assets/icon.jpg">
    <link rel="apple-touch-icon" href="assets/icon.jpg">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        ischool: {
                            blue: '#1865BF',
                            'blue-light': '#E4EEF7',
                            dark: '#333333',
                            yellow: '#FFCC00',
                            grey: '#DCDCDC'
                        }
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body class="min-h-screen ischool-body">
    <!-- Header - iSchool brand -->
    <header class="ischool-header">
        <div class="container mx-auto px-4 py-4">
            <h1 class="text-2xl md:text-3xl font-bold text-white flex items-center gap-3 flex-wrap">
                <img src="assets/soi.svg" alt="SJSU School of Information" class="h-7 md:h-8 w-auto" />
                <span class="border-l border-white/80 pl-3 text-base md:text-lg">Spectre Hologram Workshop</span>
            </h1>
            <p class="text-white/90 mt-1 text-sm">Create holograms with the Pepper's Ghost effect</p>
        </div>
    </header>

    <!-- Main Container -->
    <main class="container mx-auto px-4 py-8 max-w-7xl">
        <!-- Instructions Section -->
        <section id="instructions-section" class="ischool-section">
            <h2 class="ischool-heading">How It Works</h2>
            <div class="grid md:grid-cols-2 gap-4 ischool-text">
                <div>
                    <h3 class="ischool-subheading">What is Spectre Hologram?</h3>
                    <p class="text-sm">The Spectre device is a plastic pyramid prism that sits on your phone screen. It uses the <strong class="text-[#1865BF]">Pepper's Ghost effect</strong> — a reflection-based optical illusion — to create a stunning 3D floating hologram!</p>
                </div>
                <div>
                    <h3 class="ischool-subheading">Quick Steps</h3>
                    <ol class="list-decimal list-inside text-sm space-y-1">
                        <li>Upload a file or take a photo with your camera</li>
                        <li>We'll format it for 4-face display</li>
                        <li>Preview the hologram effect</li>
                        <li>Download and place on your phone</li>
                        <li>Add the pyramid prism and enjoy!</li>
                    </ol>
                </div>
            </div>
        </section>

        <!-- Upload Section -->
        <section id="upload-section" class="ischool-section">
            <h2 class="ischool-heading">Upload Your Content</h2>
            <div class="mt-4 flex justify-center gap-2 flex-wrap">
                <button type="button" id="camera-btn" class="ischool-btn ischool-btn-primary">
                    Record / Take Photo
                </button>
                <button type="button" id="toggle-upload-btn" class="ischool-btn ischool-btn-secondary">
                    Upload file
                </button>
            </div>
            <div id="upload-panel" class="hidden mt-4">
                <div id="drop-zone" class="ischool-drop-zone">
                    <input type="file" id="file-input" accept="video/*,image/*" class="hidden">
                    <div class="ischool-drop-zone-text">
                        <svg class="w-16 h-16 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path>
                        </svg>
                        <p class="text-lg font-semibold mb-2">Drag & drop your file here</p>
                        <p class="text-sm">or click to browse</p>
                        <p class="text-xs mt-2 opacity-80">Supports: MP4, WebM, GIF, PNG, JPG — or take a photo below</p>
                    </div>
                </div>
            </div>
            <div id="camera-section" class="hidden mt-4 p-4 bg-[#333333] rounded-lg">
                <p class="text-white text-sm mb-2">Position your subject inside the trapezoid — this is how it will appear in the hologram</p>
                <div class="flex justify-center">
                    <div class="camera-preview-wrapper relative inline-block rounded overflow-hidden border-2 border-[#1865BF]">
                        <video id="camera-preview" class="block max-w-full rounded" autoplay playsinline muted></video>
                        <div class="camera-trapezoid-overlay" aria-hidden="true">
                            <svg class="absolute inset-0 w-full h-full" viewBox="0 0 100 100" preserveAspectRatio="none">
                                <!-- Darkened area with trapezoid cutout (narrow at bottom, wide at top) -->
                                <path fill-rule="evenodd" fill="rgba(0,0,0,0.55)" d="M0,0 L100,0 L100,100 L0,100 Z M 32,100 L 68,100 L 95,0 L 5,0 Z"/>
                                <!-- Trapezoid outline: smaller narrow base, bigger wide base -->
                                <path fill="none" stroke="rgba(255,255,255,0.9)" stroke-width="2.5" vector-effect="non-scaling-stroke" d="M 5,0 L 95,0 L 68,100 L 32,100 Z"/>
                            </svg>
                        </div>
                    </div>
                </div>
                <div class="mt-3 flex gap-2 justify-center flex-wrap">
                    <button type="button" id="capture-btn" class="ischool-btn ischool-btn-cta">Capture photo</button>
                    <button type="button" id="record-btn" class="ischool-btn ischool-btn-accent">Record video</button>
                    <button type="button" id="stop-record-btn" class="hidden ischool-btn ischool-btn-secondary">Stop recording</button>
                    <button type="button" id="camera-cancel-btn" class="ischool-btn ischool-btn-secondary">Cancel</button>
                </div>
                <div id="recording-status" class="hidden mt-3 text-center">
                    <p class="text-[#FFCC00] text-sm font-semibold">
                        <span class="recording-dot" aria-hidden="true"></span>
                        Recording... <span id="recording-timer">10</span>s remaining
                    </p>
                </div>
            </div>
            <div id="file-info" class="hidden mt-4 p-4 ischool-file-info rounded-lg">
                <p class="text-[#333333]"><span class="font-semibold">File:</span> <span id="file-name"></span></p>
                <p class="text-[#1865BF] text-sm mt-1"><span class="font-semibold">Type:</span> <span id="file-type"></span></p>
            </div>
        </section>

        <!-- Fade Animation Section -->
        <section id="animation-section" class="ischool-section">
            <details id="fade-settings-details" class="group">
                <summary class="ischool-heading list-none cursor-pointer flex items-center justify-between gap-2 mb-0">
                    <span>Fade Animation Settings</span>
                    <span class="inline-block transition-transform group-open:rotate-180">▼</span>
                </summary>
                <div class="mt-4 space-y-4">
                    <div class="grid md:grid-cols-2 gap-4">
                        <div class="p-4 border border-[#DCDCDC] rounded-lg">
                            <label for="animation-image-1" class="block text-sm font-semibold mb-2">Image A</label>
                            <input id="animation-image-1" type="file" accept="image/*" class="block w-full text-sm" />
                        </div>
                        <div class="p-4 border border-[#DCDCDC] rounded-lg">
                            <label for="animation-image-2" class="block text-sm font-semibold mb-2">Image B</label>
                            <input id="animation-image-2" type="file" accept="image/*" class="block w-full text-sm" />
                        </div>
                    </div>
                    <div class="mt-4 grid md:grid-cols-4 gap-3">
                        <div>
                            <label for="fade-duration" class="block text-xs font-semibold mb-1">Fade duration (seconds)</label>
                            <input id="fade-duration" type="range" min="1" max="8" step="0.5" value="2" class="w-full" />
                            <p class="text-xs text-[#333333] mt-1"><span id="fade-duration-value">2.0</span>s</p>
                        </div>
                        <div>
                            <label for="fade-fps" class="block text-xs font-semibold mb-1">FPS</label>
                            <select id="fade-fps" class="w-full p-2 border border-[#DCDCDC] rounded">
                                <option value="12">12</option>
                                <option value="24" selected>24</option>
                                <option value="30">30</option>
                            </select>
                        </div>
                        <div>
                            <label for="fade-direction" class="block text-xs font-semibold mb-1">Direction</label>
                            <select id="fade-direction" class="w-full p-2 border border-[#DCDCDC] rounded">
                                <option value="forward">A → B</option>
                                <option value="reverse">B → A</option>
                                <option value="pingpong" selected>A ↔ B</option>
                            </select>
                        </div>
                        <div class="flex items-end">
                            <label class="inline-flex items-center gap-2 text-sm">
                                <input id="fade-loop" type="checkbox" checked />
                                Loop preview
                            </label>
                        </div>
                    </div>
                    <div class="mt-4 flex gap-2 flex-wrap">
                        <button id="generate-animation-btn" class="ischool-btn ischool-btn-primary" type="button">Generate Fade Animation</button>
                        <div class="flex gap-2 items-center">
                            <label for="animation-export-format" class="text-sm font-semibold">Export:</label>
                            <select id="animation-export-format" class="p-2 border border-[#DCDCDC] rounded">
                                <option value="video">Video (WebM/MP4)</option>
                                <option value="gif">Animated GIF</option>
                            </select>
                            <button id="download-animation-btn" class="ischool-btn ischool-btn-cta" type="button" disabled>Download Animation</button>
                        </div>
                    </div>
                    <div id="animation-export-progress-wrap" class="hidden mt-3">
                        <div class="animation-export-progress-track">
                            <div id="animation-export-progress-fill" class="animation-export-progress-fill" style="width: 0%"></div>
                        </div>
                        <p id="animation-export-progress-text" class="text-xs mt-1 text-[#333333]">0%</p>
                    </div>
                    <p id="animation-status" class="hidden mt-3 text-sm text-[#1865BF] font-semibold"></p>
                </div>
            </details>
        </section>

        <!-- Processing Section -->
        <section id="processing-section" class="hidden ischool-section">
            <div class="flex items-center justify-center gap-4">
                <div class="animate-spin rounded-full h-8 w-8 border-2 border-[#E4EEF7] border-t-[#1865BF]"></div>
                <p class="text-[#333333] text-lg">Processing your file...</p>
            </div>
            <div id="progress-bar" class="mt-4 w-full bg-[#E4EEF7] rounded-full h-2">
                <div id="progress-fill" class="bg-[#1865BF] h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
            </div>
        </section>

        <!-- Preview Section -->
        <section id="preview-section" class="hidden ischool-section">
            <div class="flex justify-between items-center mb-4 flex-wrap gap-2">
                <h2 class="ischool-heading mb-0">Preview</h2>
                <div class="flex gap-2">
                    <button id="viewer-mode-btn" class="ischool-btn ischool-btn-primary">
                        Viewer Mode
                    </button>
                    <button id="download-btn" class="ischool-btn ischool-btn-cta">
                        Download
                    </button>
                </div>
            </div>
            <div id="preview-container" class="bg-[#333333] rounded-lg p-4 flex justify-center">
                <canvas id="preview-canvas" class="max-w-full"></canvas>
            </div>
            <div class="mt-4 text-center ischool-muted text-sm">
                <p>This is how your content will appear on the phone screen</p>
            </div>
        </section>

        <!-- Viewer Mode Section: fullscreen hologram for prism placement -->
        <section id="viewer-section" class="hidden ischool-section ischool-viewer-section">
            <div class="flex justify-between items-center mb-2 flex-wrap gap-2">
                <h2 class="ischool-heading mb-0">Place prism on screen</h2>
                <div class="flex gap-2">
                    <button id="fullscreen-btn" class="ischool-btn ischool-btn-primary text-sm">Fullscreen</button>
                    <button id="exit-viewer-btn" class="ischool-btn ischool-btn-secondary">Exit Viewer</button>
                </div>
            </div>
            <div id="viewer-container" class="ischool-viewer-fullscreen">
                <img id="viewer-hologram-img" alt="Hologram for prism" class="ischool-viewer-img" />
            </div>
            <div class="mt-2 text-center ischool-muted text-sm">
                <p>Display is scaled to 2.5 in per prism side (5 in total). Go Fullscreen and place your Spectre prism on the screen.</p>
            </div>
        </section>

        <!-- Detailed Instructions (collapsible) -->
        <section id="detailed-instructions" class="ischool-section">
            <details class="group">
                <summary class="ischool-heading list-none cursor-pointer flex items-center justify-between gap-2">
                    <span>Detailed Instructions</span>
                    <span class="inline-block transition-transform group-open:rotate-180">▼</span>
                </summary>
                <div class="space-y-4 ischool-text mt-4">
                <div>
                    <h3 class="ischool-subheading">1. Understanding Pepper's Ghost Effect</h3>
                    <p class="text-sm">The plastic pyramid prism uses reflection to create a 3D illusion. Each of the 4 sides reflects one quadrant of your phone screen, making it appear as if a 3D object is floating inside the pyramid.</p>
                </div>
                <div>
                    <h3 class="ischool-subheading">2. Setting Up Your Phone</h3>
                    <ul class="list-disc list-inside text-sm space-y-1">
                        <li>Set your phone brightness to maximum</li>
                        <li>Use a dark or dimly lit room for best results</li>
                        <li>Place your phone screen facing up on a flat surface</li>
                        <li>Open the downloaded file in fullscreen mode</li>
                    </ul>
                </div>
                <div>
                    <h3 class="ischool-subheading">3. Placing the Pyramid Prism</h3>
                    <ul class="list-disc list-inside text-sm space-y-1">
                        <li>Center the pyramid prism on your phone screen</li>
                        <li>Make sure all 4 sides are touching the screen</li>
                        <li>The base should be flat against the phone</li>
                    </ul>
                </div>
                <div>
                    <h3 class="ischool-subheading">4. Viewing Your Hologram</h3>
                    <ul class="list-disc list-inside text-sm space-y-1">
                        <li>Look at the pyramid from the sides, not from above</li>
                        <li>Move around to see the effect from different angles</li>
                        <li>The darker the room, the more impressive the effect!</li>
                    </ul>
                </div>
            </div>
            </details>
        </section>
    </main>

    <footer class="container mx-auto px-4 pb-6 max-w-7xl">
        <p class="text-center text-sm font-semibold text-[#1865BF]">
            Credits: Christopher Velez, Computer Engineering Major at SJSU
        </p>
    </footer>

    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gif.js/0.2.0/gif.js"></script>
    <script src="js/image-processor.js"></script>
    <script src="js/video-processor.js"></script>
    <script src="js/animation-processor.js"></script>
    <script src="js/preview.js"></script>
    <script src="js/viewer.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
